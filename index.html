<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Ganadero B&M</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --verde:#2e7d32;
  --fondo:#f4f6f8;
  --blanco:#ffffff;
  --gris:#666;
}

body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto;
  background:var(--fondo);
}

header{
  background:var(--verde);
  color:white;
  padding:15px;
  font-size:20px;
  font-weight:600;
}

.container{
  padding:15px;
}

.card{
  background:var(--blanco);
  border-radius:14px;
  padding:15px;
  margin-bottom:15px;
  box-shadow:0 4px 10px rgba(0,0,0,.06);
}

h3{
  margin-top:0;
  color:var(--verde);
}

input, select, button{
  width:100%;
  padding:12px;
  margin:6px 0;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:15px;
}

button{
  background:var(--verde);
  color:white;
  border:none;
  font-weight:600;
}

.grid{
  display:grid;
  grid-template-columns:1fr;
  gap:15px;
}

@media(min-width:800px){
  .grid{
    grid-template-columns:1fr 1fr;
  }
}

.animal{
  border-bottom:1px solid #eee;
  padding:8px 0;
}

.small{
  font-size:13px;
  color:var(--gris);
}
</style>
</head>

<body>

<header>üêÑ Ganadero B&M</header>

<div class="container">

<!-- ESTABLECIMIENTO -->
<div class="card" id="setup">
  <h3>Establecimiento</h3>
  <input id="estNombre" placeholder="Nombre del establecimiento">
  <button onclick="guardarEst()">Guardar</button>
</div>

<div class="grid">

<!-- PANEL IZQUIERDO -->
<div class="card">
  <h3>Rodeo</h3>
  <select id="rodeoSel" onchange="mostrarRodeo()"></select>

  <div id="infoRodeo" class="small"></div>

  <div id="listaAnimales"></div>
</div>

<!-- PANEL DERECHO -->
<div class="card">
  <h3>Alta de datos</h3>

  <input id="nuevoLote" placeholder="Lote">
  <input id="nuevoRodeo" placeholder="Rodeo">

  <select id="tipo">
    <option>Vaca</option>
    <option>Toro</option>
    <option>Ternero</option>
  </select>

  <input id="aniId" placeholder="Identificaci√≥n">
  <input id="color" placeholder="Color">
  <input id="madre" placeholder="Madre (ID)">
  <input type="date" id="fecha">

  <select id="servicio">
    <option value="natural">Servicio natural</option>
    <option value="iatf">IATF</option>
  </select>

  <button onclick="alta()">Guardar</button>
</div>

</div>
</div>

<script>
let data = JSON.parse(localStorage.getItem("bm")) || {
  establecimiento:null,
  rodeos:[]
};

function save(){ localStorage.setItem("bm", JSON.stringify(data)); }

// Establecimiento
function guardarEst(){
  if(!estNombre.value) return;
  data.establecimiento = estNombre.value;
  save();
  document.getElementById("setup").style.display="none";
}

// Cargar inicial
if(data.establecimiento){
  document.getElementById("setup").style.display="none";
}

function cargarRodeos(){
  rodeoSel.innerHTML="<option value=''>Seleccionar rodeo</option>";
  data.rodeos.forEach((r,i)=>{
    rodeoSel.innerHTML+=`<option value="${i}">${r.nombre}</option>`;
  });
}

function alta(){
  if(!nuevoRodeo.value || !nuevoLote.value) return alert("Rodeo y lote");

  let rodeo = data.rodeos.find(r=>r.nombre===nuevoRodeo.value);
  if(!rodeo){
    rodeo={ nombre:nuevoRodeo.value, lote:nuevoLote.value, animales:[] };
    data.rodeos.push(rodeo);
  }

  rodeo.animales.push({
    id:aniId.value,
    tipo:tipo.value,
    color:color.value,
    madre:madre.value,
    fecha:fecha.value,
    servicio:servicio.value
  });

  aniId.value=color.value=madre.value=fecha.value="";
  save();
  cargarRodeos();
}

function mostrarRodeo(){
  let r=data.rodeos[rodeoSel.value];
  if(!r) return;

  infoRodeo.innerHTML=`Lote: <b>${r.lote}</b>`;
  listaAnimales.innerHTML="";

  r.animales.forEach(a=>{
    listaAnimales.innerHTML+=`
      <div class="animal">
        <b>${a.id}</b> (${a.tipo})<br>
        <span class="small">${a.color} ¬∑ ${a.servicio.toUpperCase()}</span>
      </div>`;
  });
}

cargarRodeos();
</script>

</body>
</html>
