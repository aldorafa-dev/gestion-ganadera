<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Monitoring Ganadero</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --verde:#1b5e20;
  --verde2:#2e7d32;
  --fondo:#f1f3f4;
  --card:#ffffff;
  --texto:#263238;
  --gris:#90a4ae;
}

body{
  margin:0;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto;
  background:var(--fondo);
  color:var(--texto);
}

header{
  background:var(--verde);
  color:white;
  padding:14px 16px;
  font-size:18px;
  font-weight:600;
}

.container{
  padding:16px;
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:16px;
}

@media(max-width:900px){
  .container{
    grid-template-columns:1fr;
  }
}

.card{
  background:var(--card);
  border-radius:14px;
  padding:14px;
  box-shadow:0 6px 16px rgba(0,0,0,0.08);
}

h3{
  margin-top:0;
  color:var(--verde2);
}

label{
  font-size:13px;
  color:var(--gris);
}

input, select{
  width:100%;
  padding:10px;
  margin:6px 0 12px 0;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:15px;
}

button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:12px;
  background:var(--verde2);
  color:white;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
}

button:active{
  transform:scale(0.98);
}

.list-item{
  border-bottom:1px solid #eee;
  padding:8px 0;
}

.badge{
  display:inline-block;
  padding:2px 8px;
  font-size:12px;
  border-radius:8px;
  background:#e8f5e9;
  color:var(--verde);
}
</style>
</head>

<body>

<header id="headerTitle">Monitoring Ganadero</header>

<div class="container">

  <!-- PANEL IZQUIERDO -->
  <div class="card">
    <h3>Rodeo</h3>

    <label>Seleccionar rodeo</label>
    <select id="rodeoSel" onchange="mostrarRodeo()"></select>

    <div id="infoRodeo"></div>

    <h3>Animales</h3>
    <div id="listaAnimales"></div>
  </div>

  <!-- PANEL DERECHO -->
  <div class="card">
    <h3>Altas de datos</h3>

    <label>Rodeo</label>
    <input id="altaRodeo" placeholder="Nombre del rodeo">

    <label>Lote</label>
    <input id="altaLote" placeholder="Nombre del lote">

    <label>Tipo de animal</label>
    <select id="altaTipo">
      <option>Vaca</option>
      <option>Toro</option>
      <option>Ternero</option>
    </select>

    <label>Identificación</label>
    <input id="altaId" placeholder="Caravana / ID">

    <label>Sexo</label>
    <input id="altaSexo" placeholder="M / H">

    <label>Color</label>
    <input id="altaColor">

    <label>Madre (ID)</label>
    <input id="altaMadre">

    <label>Servicio</label>
    <select id="altaServ">
      <option value="natural">Servicio natural</option>
      <option value="iatf">IATF</option>
    </select>

    <label>Fecha nacimiento</label>
    <input type="date" id="altaFecha">

    <button onclick="alta()">Registrar</button>
  </div>

</div>

<script>
let data = JSON.parse(localStorage.getItem("ganaderia")) || {
  establecimiento: null,
  rodeos:[]
};

if(!data.establecimiento){
  let nom = prompt("Nombre del establecimiento:");
  data.establecimiento = nom || "Establecimiento";
  guardar();
}
headerTitle.innerText = "Monitoring · " + data.establecimiento;

function guardar(){
  localStorage.setItem("ganaderia", JSON.stringify(data));
}

function alta(){
  if(!altaRodeo.value || !altaLote.value || !altaId.value){
    alert("Faltan datos");
    return;
  }

  let rodeo = data.rodeos.find(r => r.nombre === altaRodeo.value);
  if(!rodeo){
    rodeo = { nombre:altaRodeo.value, lote:altaLote.value, animales:[] };
    data.rodeos.push(rodeo);
  }

  rodeo.animales.push({
    id:altaId.value,
    tipo:altaTipo.value,
    sexo:altaSexo.value,
    color:altaColor.value,
    madre:altaMadre.value,
    servicio:altaServ.value,
    fecha:altaFecha.value
  });

  altaId.value=""; altaMadre.value=""; altaFecha.value="";
  guardar();
  cargarRodeos();
}

function cargarRodeos(){
  rodeoSel.innerHTML="<option>Seleccionar</option>";
  data.rodeos.forEach((r,i)=>{
    rodeoSel.innerHTML+=`<option value="${i}">${r.nombre}</option>`;
  });
}
cargarRodeos();

function mostrarRodeo(){
  let r = data.rodeos[rodeoSel.value];
  if(!r) return;

  infoRodeo.innerHTML = `
    <div class="list-item">
      <b>Lote:</b> ${r.lote}<br>
      <span class="badge">${r.animales.length} animales</span>
    </div>
  `;

  listaAnimales.innerHTML="";
  r.animales.forEach(a=>{
    listaAnimales.innerHTML+=`
      <div class="list-item">
        <b>${a.id}</b> (${a.tipo})<br>
        ${a.sexo} · ${a.color}<br>
        <span class="badge">${a.servicio}</span>
      </div>
    `;
  });
}
</script>

</body>
</html>
