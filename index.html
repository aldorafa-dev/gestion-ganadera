<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Livestock Monitoring</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --verde:#2f6f4e;
  --verde-claro:#e6f2ec;
  --gris:#f3f5f7;
  --card:#ffffff;
  --texto:#1f2933;
}

body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto;
  background:var(--gris);
  color:var(--texto);
}

header{
  background:var(--verde);
  color:white;
  padding:14px 18px;
  font-size:18px;
  font-weight:600;
}

.container{
  padding:15px;
}

.card{
  background:var(--card);
  border-radius:14px;
  padding:14px;
  margin-bottom:15px;
  box-shadow:0 6px 16px rgba(0,0,0,.06);
}

input, select, button{
  width:100%;
  padding:12px;
  margin:6px 0;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:15px;
}

button{
  background:var(--verde);
  color:white;
  border:none;
  font-weight:600;
}

.layout{
  display:grid;
  grid-template-columns:1fr;
  gap:15px;
}

@media(min-width:900px){
  .layout{
    grid-template-columns:2fr 1fr;
  }
}

.animal{
  padding:10px;
  border-bottom:1px solid #eee;
}

.animal:last-child{
  border-bottom:none;
}

.small{
  font-size:13px;
  color:#666;
}
</style>
</head>

<body>

<header>Livestock Monitoring</header>

<div class="container">

<!-- ESTABLECIMIENTO -->
<div class="card" id="estCard"></div>

<div class="layout">

<!-- PANEL IZQUIERDO -->
<div class="card">
  <h3>Rodeo</h3>

  <select id="rodeoSel" onchange="mostrarRodeo()"></select>

  <div id="infoRodeo" class="small"></div>

  <h4>Animales</h4>
  <div id="listaAnimales"></div>
</div>

<!-- PANEL DERECHO -->
<div class="card">
  <h3>Alta de animal</h3>

  <input id="aniId" placeholder="Identificaci贸n">
  <select id="aniCat">
    <option>Vaca</option>
    <option>Vaquillona</option>
    <option>Ternero</option>
  </select>
  <input id="aniSexo" placeholder="Sexo">
  <input id="aniColor" placeholder="Color">
  <input id="aniMadre" placeholder="Hijo de (ID madre)">
  <select id="aniServ">
    <option value="natural">Servicio natural</option>
    <option value="iatf">IATF</option>
  </select>
  <input type="date" id="aniFecha">

  <button onclick="agregarAnimal()">Agregar</button>
</div>

</div>
</div>

<script>
let data = JSON.parse(localStorage.getItem("ganaderia")) || {
  establecimiento: "",
  rodeos: []
};

function save(){
  localStorage.setItem("ganaderia", JSON.stringify(data));
}

/* ESTABLECIMIENTO */
function renderEst(){
  if(data.establecimiento){
    estCard.innerHTML = `<b>Establecimiento:</b> ${data.establecimiento}`;
  }else{
    estCard.innerHTML = `
      <h3>Establecimiento</h3>
      <input id="estNombre" placeholder="Nombre del establecimiento">
      <button onclick="setEst()">Confirmar</button>
    `;
  }
}

function setEst(){
  data.establecimiento = estNombre.value;
  save();
  renderEst();
}

/* RODEOS */
function cargarRodeos(){
  if(data.rodeos.length === 0){
    data.rodeos.push({
      nombre:"Rodeo General",
      lote:"Lote 1",
      animales:[]
    });
    save();
  }

  rodeoSel.innerHTML="";
  data.rodeos.forEach((r,i)=>{
    rodeoSel.innerHTML+=`<option value="${i}">${r.nombre}</option>`;
  });
}

function mostrarRodeo(){
  let r = data.rodeos[rodeoSel.value];
  infoRodeo.innerHTML = `Lote: ${r.lote} 路 Animales: ${r.animales.length}`;
  listaAnimales.innerHTML="";
  r.animales.forEach(a=>{
    listaAnimales.innerHTML+=`
      <div class="animal">
        <b>${a.id}</b> (${a.cat})<br>
        ${a.sexo} 路 ${a.color}<br>
        <span class="small">
          Madre: ${a.madre || "-"} 路 ${a.servicio}
        </span>
      </div>
    `;
  });
}

/* ANIMALES */
function agregarAnimal(){
  let r = data.rodeos[rodeoSel.value];
  r.animales.push({
    id:aniId.value,
    cat:aniCat.value,
    sexo:aniSexo.value,
    color:aniColor.value,
    madre:aniMadre.value,
    servicio:aniServ.value,
    fecha:aniFecha.value
  });
  aniId.value=""; aniMadre.value=""; aniFecha.value="";
  save();
  mostrarRodeo();
}

renderEst();
cargarRodeos();
mostrarRodeo();
</script>

</body>
</html>
