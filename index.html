<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Gestión Ganadera</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: Arial; padding: 15px; }
h2 { margin-top: 20px; }
input, select, button {
  width: 100%;
  padding: 10px;
  margin: 5px 0;
}
.item {
  border: 1px solid #444;
  padding: 10px;
  margin-top: 8px;
}
</style>
</head>
<body>

<h2>Establecimientos</h2>

<input id="nombreEst" placeholder="Nombre del establecimiento">
<button onclick="agregarEst()">Agregar establecimiento</button>

<select id="estSelect" onchange="mostrarLotes()">
  <option value="">-- Seleccione establecimiento --</option>
</select>

<div id="listaEst"></div>

<h2>Lotes</h2>

<input id="nombreLote" placeholder="Nombre del lote">
<button onclick="agregarLote()">Agregar lote</button>

<div id="listaLotes"></div>

<script>
let data = JSON.parse(localStorage.getItem("ganaderia")) || {
  establecimientos: []
};

function guardar() {
  localStorage.setItem("ganaderia", JSON.stringify(data));
}

function agregarEst() {
  if (!nombreEst.value) return alert("Escribí un nombre");
  data.establecimientos.push({
    nombre: nombreEst.value,
    lotes: []
  });
  nombreEst.value = "";
  guardar();
  cargarEst();
}

function cargarEst() {
  estSelect.innerHTML = "<option value=''>-- Seleccione establecimiento --</option>";
  data.establecimientos.forEach((e, i) => {
    estSelect.innerHTML += `<option value="${i}">${e.nombre}</option>`;
  });
  listaEst.innerHTML = "";
  data.establecimientos.forEach(e => {
    listaEst.innerHTML += `<div class="item"><b>${e.nombre}</b></div>`;
  });
}

function agregarLote() {
  let est = data.establecimientos[estSelect.value];
  if (!est) return alert("Seleccioná un establecimiento");
  if (!nombreLote.value) return alert("Escribí un nombre");
  est.lotes.push({ nombre: nombreLote.value, rodeos: [] });
  nombreLote.value = "";
  guardar();
  mostrarLotes();
}

function mostrarLotes() {
  listaLotes.innerHTML = "";
  let est = data.establecimientos[estSelect.value];
  if (!est) return;
  est.lotes.forEach(l => {
    listaLotes.innerHTML += `<div class="item">${l.nombre}</div>`;
  });
}

cargarEst();
</script>

</body>
</html>
