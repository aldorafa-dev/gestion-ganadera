<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Ganadero B&M</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
/* =========================
   ESTILO PROFESIONAL GANADERO
   ========================= */

:root {
  --verde: #1b5e20;
  --verde-suave: #e8f5e9;
  --gris-fondo: #f3f5f7;
  --gris-borde: #dcdfe3;
  --texto: #263238;
}

body {
  margin: 0;
  font-family: "Segoe UI", system-ui, sans-serif;
  background: var(--gris-fondo);
  color: var(--texto);
}

header {
  background: var(--verde);
  color: white;
  padding: 14px 20px;
  font-size: 20px;
  font-weight: 600;
}

.container {
  display: grid;
  grid-template-columns: 320px 1fr 360px;
  height: calc(100vh - 56px);
}

/* PANEL IZQUIERDO */
.sidebar {
  background: white;
  border-right: 1px solid var(--gris-borde);
  padding: 15px;
  overflow-y: auto;
}

.sidebar h3 {
  margin-top: 0;
  color: var(--verde);
}

.select, input, button {
  width: 100%;
  padding: 10px;
  margin: 6px 0;
  font-size: 14px;
}

select, input {
  border-radius: 6px;
  border: 1px solid var(--gris-borde);
}

button {
  background: var(--verde);
  color: white;
  border: none;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
}

/* PANEL CENTRAL */
.main {
  padding: 20px;
  overflow-y: auto;
}

.card {
  background: white;
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 16px;
  border: 1px solid var(--gris-borde);
}

.stats {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
}

.stat {
  background: var(--verde-suave);
  padding: 14px;
  border-radius: 10px;
  text-align: center;
  cursor: pointer;
}

.stat strong {
  display: block;
  font-size: 22px;
}

/* PANEL DERECHO */
.panel {
  background: white;
  border-left: 1px solid var(--gris-borde);
  padding: 15px;
  overflow-y: auto;
}

.panel h3 {
  margin-top: 0;
  color: var(--verde);
}

/* LISTADOS */
.list-item {
  padding: 10px;
  border-bottom: 1px solid var(--gris-borde);
  cursor: pointer;
}

.list-item:hover {
  background: #f7f9fa;
}

.small {
  font-size: 13px;
  color: #666;
}
</style>
</head>

<body>

<header>Ganadero B&M</header>

<div class="container">

  <!-- PANEL IZQUIERDO -->
  <div class="sidebar">
    <h3>Establecimiento</h3>
    <input id="estNombre" placeholder="Nombre del establecimiento">
    <button onclick="setEst()">Definir establecimiento</button>

    <hr>

    <h3>Selección de Rodeo</h3>
    <select id="rodeoSel" onchange="loadRodeo()"></select>
  </div>

  <!-- PANEL CENTRAL -->
  <div class="main">

    <div class="card">
      <h3>Resumen del Rodeo</h3>
      <div id="rodeoInfo" class="small">Seleccione un rodeo</div>
    </div>

    <div class="card">
      <div class="stats">
        <div class="stat" onclick="listar('Vaca')">
          <strong id="cantVacas">0</strong>
          Vacas
        </div>
        <div class="stat" onclick="listar('Toro')">
          <strong id="cantToros">0</strong>
          Toros
        </div>
        <div class="stat" onclick="listar('Ternero')">
          <strong id="cantTerneros">0</strong>
          Terneros/as
        </div>
      </div>
    </div>

    <div class="card">
      <h3>Listado</h3>
      <div id="lista"></div>
    </div>

  </div>

  <!-- PANEL DERECHO -->
  <div class="panel">
    <h3>Altas</h3>

    <select id="tipoAlta" onchange="mostrarAlta()">
      <option value="">Qué desea dar de alta</option>
      <option value="rodeo">Rodeo</option>
      <option value="animal">Animal</option>
    </select>

    <div id="altaRodeo" style="display:none">
      <input id="rodeoNombre" placeholder="Nombre del rodeo">
      <input id="rodeoLote" placeholder="Lote asignado">
      <button onclick="addRodeo()">Agregar rodeo</button>
    </div>

    <div id="altaAnimal" style="display:none">
      <input id="aniId" placeholder="Identificación">
      <select id="aniTipo">
        <option>Vaca</option>
        <option>Toro</option>
        <option>Ternero</option>
      </select>
      <select id="aniRodeo"></select>
      <button onclick="addAnimal()">Agregar animal</button>
    </div>

  </div>

</div>

<script>
/* =========================
   LÓGICA
   ========================= */

let data = JSON.parse(localStorage.getItem("ganaderoBM")) || {
  establecimiento: "",
  rodeos: []
};

function save(){ localStorage.setItem("ganaderoBM", JSON.stringify(data)); }

function setEst(){
  data.establecimiento = estNombre.value;
  save();
}

function mostrarAlta(){
  altaRodeo.style.display = tipoAlta.value === "rodeo" ? "block" : "none";
  altaAnimal.style.display = tipoAlta.value === "animal" ? "block" : "none";
}

function addRodeo(){
  data.rodeos.push({
    nombre: rodeoNombre.value,
    lote: rodeoLote.value,
    animales: []
  });
  save();
  cargarRodeos();
}

function cargarRodeos(){
  rodeoSel.innerHTML = "<option>Seleccione</option>";
  aniRodeo.innerHTML = "";
  data.rodeos.forEach((r,i)=>{
    rodeoSel.innerHTML += `<option value="${i}">${r.nombre}</option>`;
    aniRodeo.innerHTML += `<option value="${i}">${r.nombre}</option>`;
  });
}

function loadRodeo(){
  let r = data.rodeos[rodeoSel.value];
  if(!r) return;

  rodeoInfo.innerHTML = `
    Rodeo: <b>${r.nombre}</b><br>
    Lote actual: <b>${r.lote}</b>
  `;

  let vacas = r.animales.filter(a=>a.tipo==="Vaca").length;
  let toros = r.animales.filter(a=>a.tipo==="Toro").length;
  let terneros = r.animales.filter(a=>a.tipo==="Ternero").length;

  cantVacas.textContent = vacas;
  cantToros.textContent = toros;
  cantTerneros.textContent = terneros;

  lista.innerHTML = "";
}

function listar(tipo){
  let r = data.rodeos[rodeoSel.value];
  lista.innerHTML = "";
  r.animales.filter(a=>a.tipo===tipo).forEach(a=>{
    lista.innerHTML += `
      <div class="list-item">
        <b>${a.id}</b><br>
        <span class="small">${a.tipo}</span>
      </div>
    `;
  });
}

function addAnimal(){
  let r = data.rodeos[aniRodeo.value];
  r.animales.push({
    id: aniId.value,
    tipo: aniTipo.value
  });
  save();
  loadRodeo();
}

cargarRodeos();
</script>

</body>
</html>
