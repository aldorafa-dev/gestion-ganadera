<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>GestiÃ³n Ganadera</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
  --verde: #1b5e20;
  --verde-sec: #2e7d32;
  --fondo: #f2f4f6;
  --card: #ffffff;
  --texto: #263238;
  --gris: #90a4ae;
}

body {
  margin: 0;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial;
  background: var(--fondo);
  color: var(--texto);
}

header {
  background: var(--verde);
  color: white;
  padding: 16px;
  font-size: 20px;
  font-weight: 600;
}

main {
  padding: 16px;
}

.section {
  background: var(--card);
  border-radius: 14px;
  padding: 14px;
  margin-bottom: 18px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.06);
}

.section h2 {
  margin: 0 0 12px 0;
  font-size: 18px;
  color: var(--verde-sec);
}

input, select {
  width: 100%;
  padding: 12px;
  margin: 6px 0;
  border-radius: 10px;
  border: 1px solid #cfd8dc;
  font-size: 15px;
}

button {
  width: 100%;
  padding: 12px;
  margin-top: 8px;
  border-radius: 12px;
  border: none;
  background: var(--verde-sec);
  color: white;
  font-size: 15px;
  font-weight: 600;
}

button:active {
  transform: scale(0.98);
}

.card {
  border: 1px solid #e0e0e0;
  border-radius: 12px;
  padding: 10px;
  margin-top: 8px;
}

.card strong {
  font-size: 15px;
}

.meta {
  font-size: 13px;
  color: var(--gris);
}
</style>
</head>

<body>

<header>
  ðŸ“¡ Livestock Monitoring
</header>

<main>

<div class="section">
  <h2>Establecimiento</h2>
  <input id="estNombre" placeholder="Nombre del establecimiento">
  <button onclick="addEst()">Agregar</button>
  <select id="estSel" onchange="loadLotes()"></select>
</div>

<div class="section">
  <h2>Lote</h2>
  <input id="loteNombre" placeholder="Nombre del lote">
  <button onclick="addLote()">Agregar</button>
  <select id="loteSel" onchange="loadRodeos()"></select>
</div>

<div class="section">
  <h2>Rodeo</h2>
  <input id="rodeoNombre" placeholder="Nombre del rodeo">
  <button onclick="addRodeo()">Agregar</button>
  <select id="rodeoSel" onchange="showAnimales()"></select>
</div>

<div class="section">
  <h2>Animal</h2>
  <input id="aniId" placeholder="IdentificaciÃ³n">
  <select id="aniCat">
    <option>Vaca</option>
    <option>Vaquillona</option>
    <option>Ternero</option>
  </select>
  <input id="aniSexo" placeholder="Sexo">
  <input id="aniColor" placeholder="Color">
  <input id="aniMadre" placeholder="Hijo de (ID madre)">
  <select id="aniServ">
    <option value="">Servicio natural</option>
    <option value="iatf">IATF</option>
  </select>
  <input type="date" id="aniFecha">
  <button onclick="addAnimal()">Registrar animal</button>
</div>

<div class="section">
  <h2>Monitoreo del rodeo</h2>
  <div id="lista"></div>
</div>

</main>

<script>
let data = JSON.parse(localStorage.getItem("ganaderia")) || { establecimientos: [] };
const save = () => localStorage.setItem("ganaderia", JSON.stringify(data));

function addEst(){
  if(!estNombre.value) return;
  data.establecimientos.push({ nombre: estNombre.value, lotes: [] });
  estNombre.value=""; save(); renderEst();
}

function renderEst(){
  estSel.innerHTML="<option value=''>Seleccionar establecimiento</option>";
  data.establecimientos.forEach((e,i)=>estSel.innerHTML+=`<option value="${i}">${e.nombre}</option>`);
}
renderEst();

function addLote(){
  let e=data.establecimientos[estSel.value];
  if(!e || !loteNombre.value) return;
  e.lotes.push({ nombre:loteNombre.value, rodeos:[] });
  loteNombre.value=""; save(); loadLotes();
}

function loadLotes(){
  loteSel.innerHTML="<option value=''>Seleccionar lote</option>";
  rodeoSel.innerHTML=""; lista.innerHTML="";
  let e=data.establecimientos[estSel.value]; if(!e) return;
  e.lotes.forEach((l,i)=>loteSel.innerHTML+=`<option value="${i}">${l.nombre}</option>`);
}

function addRodeo(){
  let l=data.establecimientos[estSel.value]?.lotes[loteSel.value];
  if(!l || !rodeoNombre.value) return;
  l.rodeos.push({ nombre:rodeoNombre.value, animales:[] });
  rodeoNombre.value=""; save(); loadRodeos();
}

function loadRodeos(){
  rodeoSel.innerHTML="<option value=''>Seleccionar rodeo</option>";
  lista.innerHTML="";
  let l=data.establecimientos[estSel.value]?.lotes[loteSel.value]; if(!l) return;
  l.rodeos.forEach((r,i)=>rodeoSel.innerHTML+=`<option value="${i}">${r.nombre}</option>`);
}

function addAnimal(){
  let r=data.establecimientos[estSel.value]?.lotes[loteSel.value]?.rodeos[rodeoSel.value];
  if(!r) return;
  r.animales.push({
    id:aniId.value, cat:aniCat.value, sexo:aniSexo.value,
    color:aniColor.value, madre:aniMadre.value,
    fecha:aniFecha.value, servicio: aniServ.value || "natural"
  });
  aniId.value=aniMadre.value=aniFecha.value="";
  save(); showAnimales();
}

function showAnimales(){
  lista.innerHTML="";
  let r=data.establecimientos[estSel.value]?.lotes[loteSel.value]?.rodeos[rodeoSel.value];
  if(!r) return;
  r.animales.forEach(a=>{
    lista.innerHTML+=`
      <div class="card">
        <strong>${a.id}</strong> â€” ${a.cat}<br>
        <span class="meta">${a.sexo} Â· ${a.color}</span><br>
        <span class="meta">Madre: ${a.madre || "-"}</span><br>
        <span class="meta">${a.servicio==="iatf"?"IATF":"Servicio natural"}</span>
      </div>`;
  });
}
</script>

</body>
</html>
