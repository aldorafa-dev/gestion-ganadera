<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Livestock Monitoring</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
  --green: #1f7a4d;
  --green-soft: #e6f2ec;
  --bg: #f2f4f6;
  --card: #ffffff;
  --text: #1f2933;
  --muted: #6b7280;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 16px;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
  background: var(--bg);
  color: var(--text);
}

/* HEADER */
header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 20px;
}

header .logo {
  width: 42px;
  height: 42px;
  border-radius: 50%;
  background: var(--green);
  color: white;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
}

header h1 {
  font-size: 18px;
  margin: 0;
}

/* SECTIONS */
.section {
  background: var(--card);
  border-radius: 16px;
  padding: 16px;
  margin-bottom: 18px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.06);
}

.section h2 {
  font-size: 16px;
  margin: 0 0 12px;
  color: var(--green);
}

/* INPUTS */
input, select {
  width: 100%;
  padding: 12px;
  margin-bottom: 10px;
  border-radius: 10px;
  border: 1px solid #d1d5db;
  font-size: 15px;
}

input:focus, select:focus {
  outline: none;
  border-color: var(--green);
}

/* BUTTONS */
button {
  width: 100%;
  padding: 12px;
  border-radius: 12px;
  border: none;
  background: var(--green);
  color: white;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
}

button:active {
  transform: scale(0.98);
}

/* LIST ITEMS */
.card {
  background: var(--green-soft);
  border-radius: 12px;
  padding: 12px;
  margin-top: 10px;
}

.card b {
  font-size: 15px;
}

.small {
  font-size: 13px;
  color: var(--muted);
}
</style>
</head>

<body>

<header>
  <div class="logo">LM</div>
  <h1>Livestock Monitoring</h1>
</header>

<div class="section">
  <h2>Establecimiento</h2>
  <input id="estNombre" placeholder="Nombre del establecimiento">
  <button onclick="addEst()">Agregar establecimiento</button>
  <select id="estSel" onchange="loadLotes()"></select>
</div>

<div class="section">
  <h2>Lote</h2>
  <input id="loteNombre" placeholder="Nombre del lote">
  <button onclick="addLote()">Agregar lote</button>
  <select id="loteSel" onchange="loadRodeos()"></select>
</div>

<div class="section">
  <h2>Rodeo</h2>
  <input id="rodeoNombre" placeholder="Nombre del rodeo">
  <button onclick="addRodeo()">Agregar rodeo</button>
  <select id="rodeoSel" onchange="showAnimales()"></select>
</div>

<div class="section">
  <h2>Animal</h2>
  <input id="aniId" placeholder="Identificación">
  <select id="aniCat">
    <option>Vaca</option>
    <option>Vaquillona</option>
    <option>Ternero</option>
  </select>
  <input id="aniSexo" placeholder="Sexo">
  <input id="aniColor" placeholder="Color">
  <input id="aniMadre" placeholder="Hijo de (ID madre)">
  <select id="aniServ">
    <option value="">Servicio natural</option>
    <option value="iatf">IATF</option>
  </select>
  <input type="date" id="aniFecha">
  <button onclick="addAnimal()">Agregar animal</button>
</div>

<div class="section">
  <h2>Animales registrados</h2>
  <div id="lista"></div>
</div>

<script>
let data = JSON.parse(localStorage.getItem("ganaderia")) || { establecimientos: [] };
function save(){ localStorage.setItem("ganaderia", JSON.stringify(data)); }

function addEst(){
  if(!estNombre.value) return alert("Nombre?");
  data.establecimientos.push({ nombre: estNombre.value, lotes: [] });
  estNombre.value="";
  save(); renderEst();
}
function renderEst(){
  estSel.innerHTML="<option value=''>Seleccionar</option>";
  data.establecimientos.forEach((e,i)=> estSel.innerHTML+=`<option value="${i}">${e.nombre}</option>`);
}
function loadLotes(){
  loteSel.innerHTML=""; rodeoSel.innerHTML=""; lista.innerHTML="";
  let e=data.establecimientos[estSel.value]; if(!e) return;
  e.lotes.forEach((l,i)=> loteSel.innerHTML+=`<option value="${i}">${l.nombre}</option>`);
}
function addLote(){
  let e=data.establecimientos[estSel.value];
  if(!e) return alert("Elegí establecimiento");
  e.lotes.push({ nombre:loteNombre.value, rodeos:[] });
  loteNombre.value="";
  save(); loadLotes();
}
function loadRodeos(){
  rodeoSel.innerHTML=""; lista.innerHTML="";
  let l=data.establecimientos[estSel.value]?.lotes[loteSel.value];
  if(!l) return;
  l.rodeos.forEach((r,i)=> rodeoSel.innerHTML+=`<option value="${i}">${r.nombre}</option>`);
}
function addRodeo(){
  let l=data.establecimientos[estSel.value]?.lotes[loteSel.value];
  if(!l) return alert("Elegí lote");
  l.rodeos.push({ nombre:rodeoNombre.value, animales:[] });
  rodeoNombre.value="";
  save(); loadRodeos();
}
function addAnimal(){
  let r=data.establecimientos[estSel.value]?.lotes[loteSel.value]?.rodeos[rodeoSel.value];
  if(!r) return alert("Elegí rodeo");
  r.animales.push({
    id:aniId.value,
    cat:aniCat.value,
    sexo:aniSexo.value,
    color:aniColor.value,
    madre:aniMadre.value,
    fecha:aniFecha.value,
    servicio: aniServ.value || "natural"
  });
  aniId.value=""; aniMadre.value=""; aniFecha.value="";
  save(); showAnimales();
}
function showAnimales(){
  lista.innerHTML="";
  let r=data.establecimientos[estSel.value]?.lotes[loteSel.value]?.rodeos[rodeoSel.value];
  if(!r) return;
  r.animales.forEach(a=>{
    let origen = a.servicio==="iatf" ? "IATF" : "Servicio natural";
    lista.innerHTML+=`
      <div class="card">
        <b>${a.id}</b> · ${a.cat}<br>
        ${a.sexo} · ${a.color}<br>
        Madre: ${a.madre || "-"}<br>
        <span class="small">${origen}</span>
      </div>`;
  });
}
renderEst();
</script>

</body>
</html>
